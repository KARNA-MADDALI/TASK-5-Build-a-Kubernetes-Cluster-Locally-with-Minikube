<!DOCTYPE html>
<html>
<head>
    <title>Expense Tracker</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        table { border-collapse: collapse; width: 60%; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background: #f4f4f4; }
        button { padding: 5px 10px; }
    </style>
</head>
<body>
<h2>Expense Tracker</h2>

<form id="expenseForm">
    <input type="text" id="name" placeholder="Expense Name" required>
    <input type="number" id="amount" placeholder="Amount" required>
    <input type="text" id="category" placeholder="Category" required>
    <button type="submit">Add Expense</button>
</form>

<h3>Expenses:</h3>
<table id="expenseTable">
    <thead>
        <tr><th>ID</th><th>Name</th><th>Amount</th><th>Category</th><th>Action</th></tr>
    </thead>
    <tbody></tbody>
</table>

<script>
const form = document.getElementById('expenseForm');
const table = document.getElementById('expenseTable').querySelector('tbody');

async function fetchExpenses() {
    const res = await fetch('http://backend-service:5000/expenses');
    const data = await res.json();
    table.innerHTML = '';
    data.forEach(exp => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${exp.id}</td>
            <td>${exp.name}</td>
            <td>${exp.amount}</td>
            <td>${exp.category}</td>
            <td><button onclick="deleteExpense(${exp.id})">Delete</button></td>
        `;
        table.appendChild(row);
    });
}

async function deleteExpense(id) {
    await fetch(`http://backend-service:5000/expenses/${id}`, { method: 'DELETE' });
    fetchExpenses();
}

form.addEventListener('submit', async e => {
    e.preventDefault();
    await fetch('http://backend-service:5000/expenses', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            name: document.getElementById('name').value,
            amount: document.getElementById('amount').value,
            category: document.getElementById('category').value
        })
    });
    form.reset();
    fetchExpenses();
});

fetchExpenses();
</script>
</body>
</html>